# Wrapper.Test.App — Тестовое приложение для DeviceWrappers

Консольное приложение для тестирования работы с принтерами и камерами через библиотеку DeviceWrappers.

## Запуск

```bash
cd Wrapper.Test.App
dotnet run
```

## Возможности

### 1. Тест принтера (Bixolon BK3-31)
- Подключение к принтеру по TCP (RAW, порт 9100)
- Загрузка профиля из `printer.profile.json`
- Инициализация ESC/POS команд (кодовая страница, настройки)
- Печать тестового чека с кириллицей и латиницей
- Автоматическая резка (если поддерживается)

**Настройка:**
- Отредактируйте `printer.profile.json` под ваш принтер (IP, кодовая страница, резка)
- При запуске введите IP принтера или используйте дефолтный

### 2. Тест камеры (локальные камеры)
- Автоматический поиск всех доступных камер (встроенная, USB и т.д.)
- Выбор камеры из списка
- Подключение и инициализация через OpenCvSharp
- Захват одиночного кадра и сохранение в JPG
- Запуск видеопотока (опционально, 5 секунд)
- Отображение информации: разрешение, формат, размер файла

**Результат:**
- Кадры сохраняются в папку с приложением: `camera_<индекс>_<дата_время>.jpg`

## Требования

- .NET 9.0 (или измените TargetFramework в .csproj)
- Зависимости (автоматически устанавливаются при сборке):
  - OpenCvSharp4
  - OpenCvSharp4.runtime.win (для Windows)
  - System.IO.Ports

## Структура

- `Program.cs` — главный файл с меню и тестами
- `printer.profile.json` — профиль принтера Bixolon BK3-31
- `Wrapper.Test.App.csproj` — файл проекта со ссылкой на DeviceWrappers

## Примеры использования

### Выбор устройства
```
========================================
  Device Wrappers Test Application
========================================

Выберите устройство:
1. Printer (Bixolon BK3-31)
2. Camera (локальная камера)
Ваш выбор: 2
```

### Работа с камерой
```
=== ТЕСТ КАМЕРЫ ===
Поиск доступных камер...
Найдено камер: 2
  1. Камера #0 (индекс 0)
  2. Камера #1 (индекс 1)

Выберите камеру (1-2): 1
Выбрана камера #0
Подключение к камере...
✓ Подключено к Local Camera #0
  Производитель: Local
  Модель: OpenCv VideoCapture
  Поддерживаемые разрешения: 640x480, 1280x720, 1920x1080

Захват кадра...
✓ Кадр захвачен и сохранён:
  Файл: camera_0_20231215_143022.jpg
  Путь: C:\...\camera_0_20231215_143022.jpg
  Разрешение: 1920x1080
  Формат: JPEG
  Размер: 245 KB
  Время: 15.12.2023 14:30:22
  Номер кадра: 1

Запустить видеопоток на 5 секунд? (y/n): y
Запуск потока...
  Получен кадр #2, размер: 243 KB
  Получен кадр #3, размер: 244 KB
  ...
✓ Поток остановлен. Захвачено кадров: 150
```

## Заметки

- Для принтера требуется физическое подключение по сети (TCP 9100)
- Для камеры используется OpenCV, поддерживаются встроенные и USB-камеры
- Индекс камеры обычно: 0 — встроенная, 1 — первая USB, 2 — вторая USB и т.д.

